$j=jQuery.noConflict();$j(function(){var a;a=$j.fn.galleria=function(a){function t(){var a=h;var b=c.imageArray[c.activeImage];if(b){var d=f.find('img[rel="'+b+'"]');d.parents("li").siblings(".active").removeClass("active");d.parents("li").addClass("active");var e=$j(new Image).attr("src",b).addClass("replaced");a.empty().append(e);if(c.captions){a.siblings(".caption").html(d.attr("title"));if(c.descriptions){_alt=d.attr("alt")!=d.attr("title")?d.attr("alt"):"";a.siblings(".description").html(_alt)}}c.onImage(e,a.siblings(".caption"),d);if(c.clickNext){e.css("cursor","pointer").click(function(){if(c.timer){clearTimeout(c.timer);c.timer=0}o()})}}else{a.siblings().andSelf().empty();f.children("li.active").removeClass("active")}}function s(){$j("body").append($j(document.createElement("div")).attr("id","css_test").css({width:"1px",height:"1px",display:"none"}));var a=$j("#css_test").width()!=1?false:true;$j("#css_test").remove();return a}function r(){o();m();if($j(".slickr-flickr-galleria").length>0)k()}function q(a){m();c.activeImage=a;t()}function p(){c.activeImage=c.activeImage>0?c.activeImage-1:c.imageArray.length-1;t()}function o(){c.activeImage=c.activeImage<c.imageArray.length-1?c.activeImage+1:0;t()}function n(a){activeImage=0;l=c.imageArray.length;for(e=0;e<l;e++){if(a==c.imageArray[e]){activeImage=e;break}}q(activeImage)}function m(){if(c.timer)clearTimeout(c.timer);c.timer=false}function k(){if(!c.timer){var a=function(){r()};c.timer=setTimeout(a,c.slideDelay)}}if(!s()){return false}var b={history:false,clickNext:true,onImage:function(a,b,c){},onThumb:function(a){},imageArray:[],activeImage:0,autoPlay:false,timer:false,slideDelay:5e3,captions:false,descriptions:false};var c=$j.extend(b,a);var d=$j(this);for(var e in c){if(e){$j(this).galleria[e]=c[e]}}var f=$j(this).children("ul").addClass("galleria");var g=$j(document.createElement("div")).insertBefore(f);var h=$j(document.createElement("div")).addClass("galleria_wrapper");var i=$j(document.createElement("span")).addClass("caption");var j=$j(document.createElement("div")).addClass("description");g.addClass("galleria_container").append(h).append(i).append(j);f.children("li").each(function(a){var b=$j(this);var d=$j.meta?$j.extend({},c,b.data()):c;d.clickNext=$j(this).is(":only-child")?false:d.clickNext;var e=$j(this).find("a").is("a")?$j(this).find("a"):false;var f=$j(this).children("img").css("display","none");var g=e?e.attr("href"):f.attr("src");c.imageArray.push(g);var h=e?e.attr("title"):f.attr("title");var i=f.attr("alt");if(i==h)i="";var j=new Image;if(d.history&&window.location.hash&&window.location.hash.replace(/\#/,"")==g){b.siblings(".active").removeClass("active");b.addClass("active")}$j(j).load(function(){$j(this).attr("alt",f.attr("alt"));var a=e?e.find("img").addClass("thumb noscale").css("display","none"):f.clone(true).addClass("thumb").css("display","none");if(e){e.replaceWith(a)}if(!a.hasClass("noscale")){var c=Math.ceil(f.width()/f.height()*b.height());var j=Math.ceil(f.height()/f.width()*b.width());if(c<j){a.css({height:"auto",width:b.width(),marginTop:-(j-b.height())/2})}else{a.css({width:"auto",height:b.height(),marginLeft:-(c-b.width())/2})}}else{window.setTimeout(function(){a.css({marginLeft:-(a.width()-b.width())/2,marginTop:-(a.height()-b.height())/2})},1)}a.attr("rel",g);a.attr("title",h);if(i)a.attr("alt",i);a.click(function(){n(a.attr("rel"))});a.hover(function(){$j(this).addClass("hover")},function(){$j(this).removeClass("hover")});b.hover(function(){b.addClass("hover")},function(){b.removeClass("hover")});b.prepend(a);a.css("display","block");d.onThumb(jQuery(a));if(b.hasClass("active")){t(g)}f.remove()}).error(function(){b.html('<span class="error" style="color:red">Error loading image: '+g+"</span>")}).attr("src",g)});$j(this).css("visibility","visible");$j(this).find(".nav .nextSlide").click(function(){m();o();return false});$j(this).find(".nav .prevSlide").click(function(){m();p();return false});$j(this).find(".nav .stopSlide").click(function(){m();return false});$j(this).find(".nav .startSlide").click(function(){r();return false});if(c.autoPlay){k()}return this}})